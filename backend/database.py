"""\nDatabase Configuration and Setup\n\nHandles database connection, session management, and base model setup\nfor the Heavenly Archive system using SQLAlchemy.\n\nAuthor: KaizerAE\nLicense: MIT\n"""\n\nfrom sqlalchemy import create_engine\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\nimport os\nfrom pathlib import Path\n\n# Database configuration\nDATABASE_URL = os.getenv(\n    \"DATABASE_URL\",\n    \"sqlite:///./heavenly_archive.db\"  # Default to SQLite for development\n)\n\n# Create database directory if it doesn't exist\nif DATABASE_URL.startswith(\"sqlite\"):\n    db_path = Path(DATABASE_URL.replace(\"sqlite:///\", \"\"))\n    db_path.parent.mkdir(parents=True, exist_ok=True)\n\n# Create SQLAlchemy engine\nengine = create_engine(\n    DATABASE_URL,\n    connect_args={\"check_same_thread\": False} if \"sqlite\" in DATABASE_URL else {},\n    echo=True  # Set to False in production\n)\n\n# Create SessionLocal class\nSessionLocal = sessionmaker(\n    autocommit=False,\n    autoflush=False,\n    bind=engine\n)\n\n# Create Base class for models\nBase = declarative_base()\n\n\ndef get_db():\n    \"\"\"\n    Database dependency for FastAPI\n    \n    Yields:\n        Session: SQLAlchemy database session\n    \"\"\"\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n\n\ndef init_db():\n    \"\"\"\n    Initialize database - Create all tables\n    \"\"\"\n    from backend.models.event import Event  # Import models\n    \n    print(\"ðŸŒ¸ Initializing Heavenly Archive database...\")\n    Base.metadata.create_all(bind=engine)\n    print(\"âœ¨ Database initialized successfully!\")\n\n\nif __name__ == \"__main__\":\n    # For testing purposes\n    init_db()
